{"version":3,"sources":["pictures-test.js"],"names":["t","id","v4","srv","req","res","url","body","uri","json","deepEqual","todo"],"mappings":"AAAA;;AAEA;;;;AACA;;;;AACA;;;;AAIA;;;;AAMA;;;;;;;AATA;;;;AAIA;;;;;;;AAOA,mBAAK,UAAL;AAAA,+BAAiB,WAAMA,CAAN,EAAW;AAC1B,QAAIC,KAAK,mBAAKC,EAAL,EAAT;;AAEA;;;;;;;;;;;AAWA,QAAIC,MAAM;AAAA,oCAAM,WAAOC,GAAP,EAAYC,GAAZ,EAAoB;AAClC,yBAAKA,GAAL,EAAU,GAAV,EAAe,EAAEJ,EAAF,EAAf;AACD,OAFS;;AAAA;AAAA;AAAA;AAAA,SAAV;;AAIA;;;;;AAKA,QAAIK,MAAM,MAAM,0BAAOH,GAAP,CAAhB;AACA;;;;AAIA,QAAII,OAAO,MAAM,8BAAQ,EAAEC,KAAKF,GAAP,EAAYG,MAAM,IAAlB,EAAR,CAAjB;AACA;AACAT,MAAEU,SAAF,CAAYH,IAAZ,EAAkB,EAAEN,EAAF,EAAlB;AACD,GA/BD;;AAAA;AAAA;AAAA;AAAA;;AAiCA;;;AAGA,cAAKU,IAAL,CAAU,QAAV;AACA,cAAKA,IAAL,CAAU,gBAAV","file":"pictures-test.js","sourcesContent":["'use strict'\r\n\r\nimport test from 'ava'\r\nimport micro, { send } from 'micro'\r\nimport uuid from 'uuid-base62'\r\n/**\r\n * permite hacer testing en microservicios con micro\r\n */\r\nimport listen from 'test-listen'\r\n/**\r\n * permite usar http pero con promesas\r\n * funciona igual que el modulo request\r\n * solo que implementa promises\r\n */\r\nimport request from 'request-promise'\r\n\r\ntest('Get /:id', async t => {\r\n  let id = uuid.v4()\r\n\r\n  /**\r\n   * Se crea el microservicio aqui solo para\r\n   * modo de prueba, es decir solo para el paso\r\n   *  del test,le paso un  request listener\r\n   * del modulo http,\r\n   * puede ser asincrono\r\n   * recibimos el request y response\r\n   * enviamos la respuesta con send(res,200,{id})\r\n   * por metodo get\r\n   */\r\n\r\n  let srv = micro(async (req, res) => {\r\n    send(res, 200, { id })\r\n  })\r\n\r\n  /**\r\n   * listen corre el servidor y retorna la url\r\n   * en que el servidor esta correndo\r\n   */\r\n\r\n  let url = await listen(srv)\r\n  /**\r\n   * resolver la promesa del request le pasaomos\r\n   * la url y retorne los datos en json\r\n   */\r\n  let body = await request({ uri: url, json: true })\r\n  /** validacion del cuerpo sea igual a id */\r\n  t.deepEqual(body, { id })\r\n})\r\n\r\n/**\r\n * Definir test sin necesidad de usar el test aun\r\n */\r\ntest.todo('POST /')\r\ntest.todo('POST /:id/like')\r\n"]}